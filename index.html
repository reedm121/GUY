<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Matrix Birthday Cake</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: black;
      color: #888;
      font-family: monospace;
      overflow: hidden;
      height: 100%;
    }
    .matrix {
      display: grid;
      place-items: center;
      height: 100vh;
    }
    pre {
      font-size: 14px;
      line-height: 1.2;
      white-space: pre;
      text-align: center;
    }
    .locked {
      color: #00FF00;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="matrix">
    <pre id="cake"></pre>
  </div>

  <script>
    // Includes space now!
    const flickerCharacters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789~|_\\/@! ";

    const cakeTemplate = [
      "                0   0                 ",
      "                |   |                 ",
      "            ____|___|____             ",
      "         0  |~ ~ ~ ~ ~ ~|   0         ",
      "         |  |           |   |         ",
      "      ___|__|___________|___|__       ",
      "      |/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\|      ",
      "  0   |       H a p p y       |   0   ",
      "  |   |/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\|   | ",
      " _|___|_______________________|___|__ ",
      "|/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\|",
      "|                                   |",
      "|         B i r t h d a y! ! !      |",
      "| ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ |",
      "|___________________________________|"
    ];

    const rows = cakeTemplate.length;
    const cols = cakeTemplate[0].length;
    const totalChars = rows * cols;
    const locked = Array(totalChars).fill(false);

    const cakeEl = document.getElementById("cake");

    function getRandomChar() {
      return flickerCharacters[Math.floor(Math.random() * flickerCharacters.length)];
    }

    function drawCake() {
      let output = "";
      for (let r = 0; r < rows; r++) {
        for (let c = 0; c < cols; c++) {
          const idx = r * cols + c;
          const targetChar = cakeTemplate[r][c];
          if (locked[idx]) {
            output += `<span class="locked">${targetChar}</span>`;
          } else {
            output += getRandomChar();
          }
        }
        output += "\n";
      }
      cakeEl.innerHTML = output;
    }

    function lockNextChar() {
      const idx = locked.findIndex(l => !l);
      if (idx !== -1) {
        locked[idx] = true;
      } else {
        clearInterval(lockTimer);
      }
    }

    // Start animation
    setInterval(drawCake, 50);         // Flicker update
    const lockTimer = setInterval(lockNextChar, 20);  // Lock one at a time
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Matrix Birthday Cake</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: black;
      color: #888;
      font-family: monospace;
      overflow: hidden;
      height: 100%;
    }
    .matrix {
      display: grid;
      place-items: center;
      height: 100vh;
    }
    pre {
      font-size: 14px;
      line-height: 1.2;
      white-space: pre;
      text-align: center;
    }
    .locked {
      color: #00FF00;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="matrix">
    <pre id="cake"></pre>
  </div>

  <script>
    const cakeTemplate = [
      "                0   0                 ",
      "                |   |                 ",
      "            ____|___|____             ",
      "         0  |~ ~ ~ ~ ~ ~|   0         ",
      "         |  |           |   |         ",
      "      ___|__|___________|___|__       ",
      "      |/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\|      ",
      "  0   |                       |   0   ",
      "  |   |/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\|   | ",
      " _|___|_______________________|___|__ ",
      "|/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\|",
      "|                                   |",
      "|                                   |",
      "| ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ |",
      "|___________________________________|"
    ];

    const message = "HAPPY BIRTHDAY GUY!";
    const messagePositions = [];

    const rows = cakeTemplate.length;
    const cols = cakeTemplate[0].length;

    // Determine message placement row/col
    const msgRow = 11;
    const msgStartCol = Math.floor((cols - message.length) / 2);
    for (let i = 0; i < message.length; i++) {
      messagePositions.push({ row: msgRow, col: msgStartCol + i, char: message[i] });
    }

    const characters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%&";
    const cake = cakeTemplate.map(line => line.split(""));
    const locked = Array(message.length).fill(false);

    const cakeEl = document.getElementById("cake");

    function getRandomChar() {
      return characters[Math.floor(Math.random() * characters.length)];
    }

    function drawCake() {
      const output = [];

      for (let r = 0; r < rows; r++) {
        let line = "";
        for (let c = 0; c < cols; c++) {
          const posIndex = messagePositions.findIndex(p => p.row === r && p.col === c);
          if (posIndex !== -1) {
            if (locked[posIndex]) {
              line += `<span class="locked">${message[posIndex]}</span>`;
            } else {
              line += getRandomChar();
            }
          } else {
            const original = cakeTemplate[r][c];
            if (original === " ") {
              line += " ";
            } else {
              line += Math.random() < 0.1 ? getRandomChar() : original;
            }
          }
        }
        output.push(line);
      }

      cakeEl.innerHTML = output.join("\n");
    }

    function lockNextChar() {
      const nextIndex = locked.findIndex(l => l === false);
      if (nextIndex !== -1) {
        locked[nextIndex] = true;
      } else {
        clearInterval(lockInterval);
      }
    }

    // Animate flickering + locking
    setInterval(drawCake, 100);
    const lockInterval = setInterval(lockNextChar, 300);
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Matrix Birthday Cake</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: black;
      color: #888;
      font-family: monospace;
      overflow: hidden;
      height: 100%;
    }
    .matrix {
      display: grid;
      place-items: center;
      height: 100vh;
    }
    pre {
      font-size: 14px;
      line-height: 1.2;
      white-space: pre;
      text-align: center;
    }
    .locked {
      color: #00FF00;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="matrix">
    <pre id="cake"></pre>
  </div>

  <script>
    const flickerCharacters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789~|_\\/@! ";

    const cakeTemplate = [
      "         0   0                    ",
      "         |   |                    ",
      "     ____|___|____                ",
      "  0 | ~ ~ ~ ~ ~ ~ | 0             ",
      "    |/\\/\\/\\/\\/\\/\\/\\|              ",
      "  0 |     H a p p y   | 0         ",
      "    |/\\/\\/\\/\\/\\/\\/\\|   |          ",
      "__|__|_______________|__|__       ",
      "|\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\|      ",
      "|       B i r t h d a y ! ! !     |",
      "| ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ |",
      "|_________________________________|"
    ];

    const rows = cakeTemplate.length;
    const cols = Math.max(...cakeTemplate.map(line => line.length));
    const totalChars = rows * cols;
    const locked = Array(totalChars).fill(false);

    const cakeEl = document.getElementById("cake");

    function getRandomChar() {
      return flickerCharacters[Math.floor(Math.random() * flickerCharacters.length)];
    }

    function drawCake() {
      let output = "";
      for (let r = 0; r < rows; r++) {
        const row = cakeTemplate[r].padEnd(cols, " ");
        for (let c = 0; c < cols; c++) {
          const idx = r * cols + c;
          const targetChar = row[c];

          const shouldLock = locked[idx] && targetChar !== " ";
          if (shouldLock) {
            output += `<span class="locked">${targetChar}</span>`;
          } else {
            output += getRandomChar();
          }
        }
        output += "\n";
      }
      cakeEl.innerHTML = output;
    }

    function lockNextChar() {
      const idx = locked.findIndex((l, i) => !l && cakeTemplate[Math.floor(i / cols)]?.[i % cols] !== " ");
      if (idx !== -1) {
        locked[idx] = true;
      } else {
        clearInterval(lockTimer);
      }
    }

    // Animate forever
    setInterval(drawCake, 50);
    const lockTimer = setInterval(lockNextChar, 20);
  </script>
</body>
</html>
